{% extends "cameras/layout.jinja" %}

{% block undertitle %}
  <a class="button historical" href="{{ url('historical', location=location.slug, camera=camera.slug) }}">
    Historical data
    <img src="{{ url('static', filename='images/history-line.svg') }}">
  </a>
{% endblock undertitle %}

{% block content %}
  <div id="per-day-refreshable" class="columns">
    {% include "cameras/per-day-refresh.jinja" %}
  </div>

  <section>
    <nav id="per-image-menu" class="channel-menu" role="navigation">
      <h3>Per Image Channels: Current</h3>
        <ul class="channels flr">
          {% for channel in camera.channels.values() %}
            {% if channel.label %}
              <li class="channel service"
                  id="{{ channel.prefix }}"
                  data-dependent-on="{{ channel.service_dependency }}">
                <a  class="button button-large {{ channel.slug }}"
                    href="{{ url('current', location=location.slug, camera=camera.slug, channel=channel.slug) }}" target="_blank">
                  <div class="heartbeat"></div>
                  <span>{{ channel.name }}</span>
                </a>
              </li>
            {% endif %}
          {% endfor %}
        </ul>
      </nav>
  </section>

  <div class="metadata-status">
    <h4>metadata service:&nbsp;</h4>
    <div class="service" id="{{ camera.metadata_slug }}_metadata">
      <div class="heartbeat"></div>
    </div>
  </div>

    <section id="channel-day-data">
      {% include "cameras/data-table-header.jinja" %}
    </section>
  {% if camera.metadata_headers %}
    <script type="application/json" id="metadata-headers">
      {{ camera.metadata_headers|tojson }}
    </script>
  {% endif %}
{% endblock content %}

{% block footer_scripts %}
  {% if camera.js_entry %}
    {% set cam_js_filename = "js/refresh-table/refresh-table-" + camera.js_entry + ".js" %}
    <script type="module" src='{{ url("static", filename=cam_js_filename) }}'></script>
  {% endif %}
  <script type="module" src="{{ url('static', filename='js/heartbeats.js') }}"></script>
{% endblock footer_scripts  %}
